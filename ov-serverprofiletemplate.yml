###
# Copyright (2016-2017) Hewlett Packard Enterprise Development LP
#
# Licensed under the Apache License, Version 2.0 (the "License");
# You may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
###
---
- hosts: localhost
  vars:
    config: "~/ansible-scripts/oneview_config.json"
  tasks:
     - name: Create server profile template Template-Gen10
       oneview_server_profile_template:
         config: "{{ config }}"
         state: present
         data:
             name:                       "Template-Gen10"
             description:                "ansible-template"
             serverProfileDescription:   "sp-ansible-description"
             enclosureGroupName:         "EG-3Frames-SAN"
             serverHardwareTypeName:     "SY 660 Gen10 1"
             affinity:                   "Bay"
             macType:                    "Virtual"
             wwnType:                    "Virtual"
             serialNumberType:           "Virtual"
             hideUnusedFlexNics:         true  
             iscsiInitiatorNameType:     "AutoGenerated"
             firmware:
                 manageFirmware:            true
                 forceInstallFirmware:      true
                 firmwareInstallType:       "FirmwareAndOSDrivers"
                 firmwareActivationType:    "Scheduled"
                 firmwareBaselineName:      "HPE Synergy Custom SPP 2018 06 19  2018 07 09"
             bootMode:
                 manageMode:    true
                 mode:          "UEFIOptimized"
                 pxeBootPolicy: "IPv4"
                 secureBoot:    "Enabled"
             boot:
                 manageBoot: true
                 order:
                     - "HardDisk" 
             bios:
                 manageBios:     true
                 overriddenSettings:
                     - id:    "WorkloadProfile" 
                       value: "Virtualization-PowerEfficient" 
                     - id:    "NumaGroupSizeOpt" 
                       value: "Clustered" 
                     - id:    "PowerRegulator" 
                       value: "OsControl" 
             localStorage:
                 sasLogicalJBODs:
                     - id: 1
                       deviceSlot: "Mezz 1"
                       name: "Mezz1-LD-1"
                       numPhysicalDrives: 2
                       driveMinSizeGB: 99
                       driveMaxSizeGB: 999
                       driveTechnology: "SasHdd"
                       eraseData: true
                     - id: 2
                       deviceSlot: "Mezz 1"
                       name: "Mezz1-LD-2"
                       numPhysicalDrives: 2
                       driveMinSizeGB: 88
                       driveMaxSizeGB: 888
                       driveTechnology: "SasHdd"
                       eraseData: true
                 controllers:
                     - deviceSlot: "Embedded"
                       mode: "Mixed"
                       initialize: true
                       logicalDrives:
                         - name: LD-1
                           raidLevel: "RAID1"
                           bootable: "false"
                           numPhysicalDrives: 2
                           driveTechnology: SataHdd
                           sasLogicalJBODId: null
                         - name: LD-2
                           raidLevel: "RAID1"
                           bootable: "false"
                           numPhysicalDrives: 2
                           driveTechnology: SataHdd
                           sasLogicalJBODId: null
                     - deviceSlot: "Mezz 1"
                       mode: "Mixed"
                       initialize: false
                       logicalDrives:
                         - name: null
                           raidLevel: "RAID1"
                           bootable: "false"
                           numPhysicalDrives: null
                           driveTechnology: null
                           sasLogicalJBODId: 1
                         - name: null
                           raidLevel: "RAID1"
                           bootable: "false"
                           numPhysicalDrives: null
                           driveTechnology: null
                           sasLogicalJBODId: 2
             connectionSettings:
                 connections:
                     - id: 1
                       portId: "Mezz 3:1-a"
                       name: "Prod-A"
                       functionType: "Ethernet"
                       networkUri: "/rest/ethernet-networks/2618144e-5d57-409c-b583-746bee238cd9" # network or networkset name is: "Production100"
                       requestedMbps: 4000
                       requestedVFs: 0
                       boot: 
                         priority: "Primary"
                         bootVlanId: null
                         ethernetBootType: "PXE"
                     - id: 2
                       portId: "Mezz 3:2-a"
                       name: "Prod-B"
                       functionType: "Ethernet"
                       networkUri: "/rest/ethernet-networks/9b4f341d-dba2-4bcd-a6dc-0bb6d06dde88" # network or networkset name is: "Production200"
                       requestedMbps: 4000
                       requestedVFs: 0
       delegate_to: localhost
 
